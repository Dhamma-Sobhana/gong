{% extends 'base.njk' %}

{% set title = 'Gong' %}

{% block content %}
  <h1>Gong</h1>
  <h2>System status</h2>
  <table id="device-status">
    <tbody>
      <tr>
        <th>System enabled</th>
        <td>{{ enabled }}</td>
      </tr>
      <tr>
        <th>Overall status</th>
        <td>
          {% if device_status.failed %}ðŸ”´ {{ device_status.failed }} device(s) offline
          {% elif device_status.warning %}ðŸŸ¡ {{ device_status.warning }} device(s) possibly offline
          {% else %}
          ðŸŸ¢ all devices online
          {% endif %}
          </td>
      </tr>
      <tr>
        <th>Devices</th>
        <td>{{ device_status.ok }} online, {{ device_status.warning }} warning, {{ device_status.failed }} offline</td>
      </tr>
      <tr>
        <th>Playing</th>
        <td>{{ playing }}</td>
      </tr>
      <tr>
        <th>Automation</th>
        <td>{{ automation.enabled }}</td>
      </tr>
      {% if enabled and automation.enabled %}
      <tr>
        <th>Next gong</th>
        <td>{{ automation.getNextGong().time.toFormat('yyyy-MM-dd HH:mm') }} in <span class="nextGongDiff">-</span></td>
      </tr>
      {% endif %}
    </tbody>
  </table>
  {% if enabled %}
  <form action="/enable" method="post">
    <button type="submit" class="red">Disable</button>
  </form>
  {% else %}
  <form action="/enable" method="post">
    <button type="submit" class="green">Enable</button>
  </form>
  {% endif %}
  <hr>
  {% if enabled %}
  {% include 'automation.njk' %}
  <hr>
  {% endif %}
  {% include 'devices.njk' %}
  <hr>
  {% include 'log.njk' %}
  {# {% include 'debug.njk'%} #}
{% endblock %}